//
//  ContentView.swift
//  Nix
//
//  Created by Su Lei Yadanar on 2/15/24.
//

import SwiftUI
import DeviceActivity
<<<<<<< HEAD

let lavender = Color(red: 0.8, green: 0.85, blue: 0.95)
let purple = Color(red: 0.45, green: 0.3, blue: 0.6)
=======
>>>>>>> e319906645e422bf1938724ee22d5e691c983c2d

struct MainView: View {

    
    @StateObject var viewModel = MainViewViewModel()
    
    var body: some View  {
        if viewModel.isSignedIn, !viewModel.currentUserId.isEmpty {
            //signed in
            accountView
        } else {
            //            ResponsiveView { properties in
            NavigationView{
                LoginView().padding(0)
            }
            //            }
        }
        
    }
    
    var tabs = ["house.fill", "chart.bar.doc.horizontal.fill", "timer.circle.fill", "person.crop.circle.fill"]
    

    @State var selectedTab = "house.fill"
    @Namespace var namespace
    
    
    var accountView: some View {
        
        ZStack(alignment: Alignment(horizontal: .center, vertical: .bottom)) {
            
            TabView(selection: $selectedTab) {
                HomepageView(userId: viewModel.currentUserId)
                    .ignoresSafeArea()
                    .tag("house.fill")
                RulesView(userId: viewModel.currentUserId)
                    .ignoresSafeArea()
                    .tag("chart.bar.doc.horizontal.fill")
                PomodoroView()
                    .ignoresSafeArea()
                    .tag("timer.circle.fill")
                ProfileView()
                    .ignoresSafeArea()
                    .tag("person.crop.circle.fill")
            }
        }
        
        
        
        .overlay (
            CustomTabBar(),
            alignment: .bottom // moves it to bottom of screen
        )
        

        .ignoresSafeArea()
    }
    
    @ViewBuilder
    func CustomTabBar() -> some View {
        HStack(spacing: 15) {
            ForEach(tabs, id: \.self) { image in
                Button {
                    withAnimation(Animation.interactiveSpring(dampingFraction: 2)) {
                        selectedTab = image
                    }
                } label: {
                    VStack {
                        Image(systemName: image)
                            .resizable()
                            .aspectRatio(contentMode: .fit)
                            .frame(width: 30, height: 30)
                            .foregroundColor(selectedTab == image ? purple : .gray)
                      
                        if (selectedTab == image) {
                            Rectangle()
                                .frame(width: 35, height: 3)
                                .foregroundColor(purple)
                                .padding(.top, 2) // Adjust spacing as needed
                        }
                    }
                        
                }
                
                .padding(.horizontal, 20)
                .padding(.vertical, 20)
                 
            }
            
            
        }
        
        .background(lavender)
        .cornerRadius(35)
        .padding(.bottom, UIApplication.shared.windows.first?.safeAreaInsets.bottom)
        
        
    }
}

//#Preview {
//    MainView()
//}
